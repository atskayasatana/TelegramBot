# TelegramBot

Скрипт для загрузки фотографий в телеграм канал.

Для запуска нужен Python версии не ниже 3, а также библиотеки из файла requirements.txt. Архив с кодом нужно скачать к себе на компьютер и разархивировать в любую удобную директорию.

Перед началом работы установим необходимые библиотеки:
```Python
pip install -r requirements.txt
```
Для работы также понадобятся api_key, который можно сгенерировать здесь: https://api.nasa.gov/ и токен для ТелеграмБота.

При первом запуске нужно создать файл окружения, в котором будут хранится необходимые для работы ключи и токены.
Запускаем скрипт set_environment.py

```Python
python set_environment.py
```
Будут запрошены ключ для сайта и токен для телеграма.

![](https://github.com/atskayasatana/Images/blob/f554af1ba1e3ed3db65425c06cbe5dd84e919647/4_token.png)

Эти данные будут записаны в .env файл и использоваться при запусках скриптов для бота.
Если ключи меняются, то скрипт нужно запустить снова и передать новые значения.


Контент для телеграм-канала скачивается с сайтов: https://api.spacexdata.com/ и https://api.nasa.gov/.

 ## Скрипты для скачивания
 
 ### fetch_spacex_images.py
 
 Скачивает фотографии с запусков SpaceX.
 
 ```Python
 python fetch_spacex_images.py [id запуска]
 ```
 Если указать id запуска, то будут скачаны фотографии с запуска с указанным id. При запуске скрипта без данного параметра, то будут скачаны фотографии 
 с последнего запуска во время которого делались фото. Фотографии скачтваются в папку Images в директории проекта.
 
 
 ### fetch_picture_of_a_day.py
 
 Скачивает картинку дня - astronomy picture of the day c сайта NASA в папку APOD директории проекта.
 
  
 ```Python
 python fetch_picture_of_a_day.py [количество картинок для скачивания]
 ```
 Если не указать количество картинок для скачивания то, по будет скачано 5 картинок. 
 На сайте установлено ограничение в 100 картинок для скачивания, поэтому при указании значения больше 100 будет скачано 100 картинок. 
 
 
### fetch_epic_images.py

Скачивает изображения Земли с EPIC камеры NASA в папку EPIC директории проекта.

```Python
python fetch_epic_images.py [количество картинок для скачивания]
```

Если не указать количество картинок для скачивания, то будут сказаны 10 последних изображений. 

## Функции
## functions.py
Файл с общими функциями, которые используются во всех скриптах(работа с датами, скачивание)

### parse_date(date)
Принимает на вход дату в формате datetime и возвращает три значения: год, месяц, день в текстовом формате с 0 в начале для значений меньше 10.

### download_img(img_url, download_path)

Скачивает картину с img_url в файл download_path

### get_file_extension(url)

Функция для получения расширения файла с указанным url

### get_image(path)

Загружает картинку c адресом path в объект для дальнейшей работы.


 ## space_x_functions.py

Функции для скачивания запусков SpaceX

### get_foto_of_launch_by_id(url, launch_id)

Возвращает список ссылок на фотографии с запуска SpaceX с заданным launch_id.

### get_latest_launch_foto(url)

Возвращает список ссылок на фотографии с самого последнего запуска Space_X/

### get_launch_id(url)

Функция для поиска проследнего запуска, для которого есть фотографии. Если get_latest_launch_foto вернула пустой список ссылок, то можно вызвать get_launch_id и найти последний запуск с фотографиями. Поиск идет с 1 января 2022 по текущую дату.

### fetch_spacex_launch_images(links, path)

Функция для скачивания фотографий по списку ссылок links в директорию path.

## APOD_functions.py

Функции для скачивания картинки дня

### get_APOD(url,query, download_dir_name)

Функция для скачивания картинок дня в указанную в download_dir_name директорию. Аргумент query содержит параметры запроса, такие как api_key и количество картинок для скачивания.

## EPIC_functions.py

Функции для скачивания изображений с EPIC камеры.

### get_EPIC(params,download_dir_name, number_of_images)

Скачивает указанное в number_of_images число изображений с epic камеры в папку download_dir_name. Функция собирает нужное количество изображений начиная от текущей даты по каждому дню.

## bot.py

Код для публикации контента в телеграмм-канал. 

```Python
python bot.py 
```
После запуска скритп попросит указать id чата, путь к файлу для первой отправки и частоту публикаций в часах. 
ID чата обязательный параметр, если он не указан, то работа прерывается.
Если не указан путь к картинке или путь указан неверно, то будет отправлена случайная 
картинка.

![](https://github.com/atskayasatana/Images/blob/6fd1ccb01543c8631731359896f6b4cddeb0b3f4/4_%D0%B1%D0%B5%D0%B7%20%D1%84%D0%B0%D0%B9%D0%BB%D0%B0.png)

Путь нужно указывать полностью:

![](https://github.com/atskayasatana/Images/blob/6fd1ccb01543c8631731359896f6b4cddeb0b3f4/4_%D1%84%D0%B0%D0%B9%D0%BB.png)

Периодичность публикаций по умолчанию равна 4 часам(если не будет указано другое время при запуске).




 
 
 
 
 
